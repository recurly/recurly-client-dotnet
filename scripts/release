#!/usr/bin/env bash

set -e

# Usage
#
# ./release
#

# Environment verification
if [ -z "$NUGET_TOKEN" ]; then
  echo "NUGET_TOKEN must be set. Aborting."
  exit 1
fi

#clean
rm -rf "$(pwd)"/Recurly/bin/

#publish
dotnet pack -c Release
dotnet build -c Release
dotnet nuget push "$(pwd)"/Recurly/bin/Release/Recurly.*.nupkg -s https://api.nuget.org/v3/index.json -k "$NUGET_TOKEN"

